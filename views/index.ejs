<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <style>
        .form-container {
            display: flex;
            flex-wrap: nowrap;
        }

        .left-form {
            flex: 0 0 40%; /* Adjust this value to control the left table's width */
            margin-right: 10px;
        }

        .right-form {
            flex: 1; /* Right table takes the remaining space */
            max-width: 40%;
        }

        .address-container {
            margin-top: 20px;
            text-align: center;
        }

        .address-container .form-group {
            display: inline-block;
            margin: 0 10px;
            text-align: left;
        }
        .lbl-left {
            font-size: small;
        }
        .lbl-right{
            font-size: small;
        }
        .form-control {
            height: 25px;
        }
        .breakdown-input {
            width: 160px;
            height: 25px;
        }
        .breakdown-header {
            font-weight: 200;
        }
        .monthly-breakdown{
            background-color: darkgray;
        }

    </style>
</head>
<body>
    <div class="container">
        <button type="button" id="populateTestData" class="btn btn-secondary mt-3">Add Test Data</button>
        <form id="mortgageForm" action="/submit" method="POST">
            <div class="card mb-4">
                <div class="card-body">
                    <!-- Left and Right Tables -->
                    <div class="form-container">
                        <!-- Left Table -->
                        <div class="left-form">
                            <table class="table table-bordered">
                                <tr>
                                    <td><label class="lbl-left" for="borrowerName">Borrower Name</label></td>
                                    <td><input type="text" class="form-control" id="borrowerName" name="borrowerName" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="mortgageBalance">Current 1st Mortgage Balance</label></td>
                                    <td><input type="text" class="form-control currency-input" id="mortgageBalance" name="mortgageBalance" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="mortgageRate">Current 1st Mortgage Rate (%)</label></td>
                                    <td><input type="number" class="form-control" id="mortgageRate" name="mortgageRate" step="0.0001" min="0" max="100" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="currentPITIFirst">Current P I T I 1st Mtg. </label></td>
                                    <td><input type="text" class="form-control currency-input" id="currentPITIFirst" name="currentPITIFirst" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="currentP&IorIOFirst">Current P & I or IO Pymt 1st Mtg</label></td>
                                    <td><input type="text" class="form-control currency-input" id="currentP&IorIOFirst" name="currentP&IorIOFirst" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="currentMonthlyMI">Current Monthy Mortgage Ins (MI)</label></td>
                                    <td><input type="text" class="form-control currency-input" id="currentMonthlyMI" name="currentMonthlyMI" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="currentAnnualTaxes">Current Annual Taxes</label></td>
                                    <td><input type="text" class="form-control currency-input" id="currentAnnualTaxes" name="currentAnnualTaxes" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="currentAnnualInsurance">Current Annual Insurance</label></td>
                                    <td><input type="text" class="form-control currency-input" id="currentAnnualInsurance" name="currentAnnualInsurance" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="currentInsPolEffDate">Current Ins Policy Eff. Date</label></td>
                                    <td><input type="text" class="form-control currency-input" id="currentInsPolEffDate" name="currentInsPolEffDate" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="current2ndMtgBal">Current 2nd Mtg Bal</label></td>
                                    <td><input type="text" class="form-control currency-input" id="current2ndMtgBal" name="current2ndMtgBal" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="current2ndMtgRate">Current 2nd Mtg Rate</label></td>
                                    <td><input type="text" class="form-control currency-input" id="current2ndMtgRate" name="current2ndMtgRate" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="currentP&IorIOSecond">Current P & I or IO Pymt 2nd</label></td>
                                    <td><input type="text" class="form-control currency-input" id="currentP&IorIOSecond" name="currentP&IorIOSecond" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="totalPITIFirstSecond">Total PITI 1st & 2nd</label></td>
                                    <td><input type="text" class="form-control currency-input" id="totalPITIFirstSecond" name="totalPITIFirstSecond" required></td>
                                </tr>
                                
                                <tr>
                                    <td><label class="lbl-left" for="totalPIMI12Other">Total P&I & MI on 1st & 2nd & Other Debt</label></td>
                                    <td><input type="text" class="form-control currency-input" id="totalPIMI12Other" name="totalPIMI12Other" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="balOfOtherDebts">Bal of "Other" Debts to Payoff</label></td>
                                    <td><input type="text" class="form-control currency-input" id="balOfOtherDebts" name="balOfOtherDebts" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="monthlyPmtOtherDebt">Mo. Pymt of "Other" Debt to payoff</label></td>
                                    <td><input type="text" class="form-control currency-input" id="monthlyPmtOtherDebt" name="monthlyPmtOtherDebt" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="lastPaymentDate">Last Payment Date</label></td>
                                    <td><input type="date" class="form-control" id="lastPaymentDate" name="lastPaymentDate" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="estClosingDate">Est. Closing Date</label></td>
                                    <td><input type="date" class="form-control" id="estClosingDate" name="estClosingDate" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="fundingDate">Funding Date</label></td>
                                    <td><input type="date" class="form-control" id="fundingDate" name="fundingDate" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="monthEnd">Month end</label></td>
                                    <td><input type="date" class="form-control" id="monthEnd" name="monthEnd" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="noPaymentDueMonth">No Payment Due Month</label></td>
                                    <td><input type="date" class="form-control" id="noPaymentDueMonth" name="noPaymentDueMonth" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="firstPmtDueDate">1st Payment due date</label></td>
                                    <td><input type="date" class="form-control" id="firstPmtDueDate" name="firstPmtDueDate" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="estEscrowRefund">Est Escrow Refund (be conservative)</label></td>
                                    <td><input type="text" class="form-control currency-input" id="estEscrowRefund" name="estEscrowRefund" required></td>
                                </tr>
                                <!-- <tr>
                                    <td><label class="lbl-left" for="estimatedEscrowRefund">Estimated Escrow Refund</label></td>
                                    <td><input type="text" class="form-control currency-input" id="estimatedEscrowRefund" name="estimatedEscrowRefund" required></td>
                                </tr> -->
                                <tr>
                                    <td><label class="lbl-left" for="appraisedValue">Appraised Value</label></td>
                                    <td><input type="text" class="form-control currency-input" id="appraisedValue" name="appraisedValue" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="ficoScore">FICO Score</label></td>
                                    <td><input type="number" class="form-control" id="ficoScore" name="ficoScore" required></td>
                                </tr>
                                <tr>
                                    <td><label class="lbl-left" for="newInterestRate">New Interest Rate (%)</label></td>
                                    <td><input type="number" class="form-control" id="newInterestRate" name="newInterestRate" step="0.0001" min="0" max="100" required></td>
                                </tr>
                            </table>
                        </div>

                        <!-- Right Table -->
                        <div class="right-form">
                            <table class="table table-bordered">
                                <thead>
                                    <tr class="monthly-breakdown">
                                        <th colspan="4">Monthly Payment Breakdown</th>
                                    </tr>
                                    <tr>
                                        <th class="breakdown-header">Component</th>
                                        <th class="breakdown-header">Value</th>
                                        <th class="breakdown-header">Calculation</th>
                                        <th class="breakdown-header">Annual</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="lbl-right">Principle</td>
                                        <td><input class="breakdown-input" type="number" id="principleInput" value="502.18" class="form-control"></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td class="lbl-right">Interest</td>
                                        <td><input class="breakdown-input" type="number" id="interestInput" value="3928.11" class="form-control"></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td class="lbl-right">Taxes</td>
                                        <td><input class="breakdown-input" type="number" id="taxesMonthly" class="form-control" readonly style="background-color: #f9f9f9;"></td>
                                        <td><input class="breakdown-input" type="number" id="taxesCalc" class="form-control" readonly style="background-color: #f9f9f9;"></td>
                                        <td><input class="breakdown-input" type="number" id="taxesAnnual" value="4335.56" class="form-control"></td>
                                    </tr>
                                    <tr>
                                        <td class="lbl-right">Insurance</td>
                                        <td><input class="breakdown-input" type="number" id="insuranceInput" value="216.80" class="form-control"></td>
                                        <td><input class="breakdown-input" type="number" id="insuranceCalc" class="form-control" readonly style="background-color: #f9f9f9;"></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td class="lbl-right">MIP?</td>
                                        <td><input class="breakdown-input" type="number" id="mipCalc" class="form-control" readonly style="background-color: #f9f9f9;"></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td class="lbl-right">Escrow</td>
                                        <td><input class="breakdown-input" type="number" id="escrowInput" value="693.92" class="form-control"></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td class="lbl-right">Escrow Balance</td>
                                        <td><input class="breakdown-input" type="number" id="escrowBalanceInput" value="272.35" class="form-control"></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td class="lbl-right">Total Monthly</td>
                                        <td colspan="3"><input class="breakdown-input" type="number" id="totalMonthly" class="form-control" readonly style="background-color: #e0e0e0;" placeholder="Total Monthly"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Address Section -->
                    <div class="address-container">
                        <div class="form-group">
                            <label for="address">Address</label>
                            <input type="text" class="form-control" id="address" name="address" autocomplete="off" placeholder="Start typing an address..." required>
                        </div>
                        <div class="form-group">
                            <label for="locality">City</label>
                            <input type="text" class="form-control" id="locality" name="locality" required>
                        </div>
                        <div class="form-group">
                            <label for="state">State</label>
                            <select class="form-control" id="state" name="state" required>
                                <option value="">Select a state</option>
                                <% if (typeof error === 'undefined') { %>
                                    <% states.forEach(function(state) { %>
                                        <option value="<%= state.code %>"><%= state.name %></option>
                                    <% }); %>
                                <% } %>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="postalCode">Postal Code</label>
                            <input type="text" class="form-control" id="postalCode" name="postalCode" required>
                        </div>
                    </div>

                    <div class="mt-4">
                        <button type="submit" class="btn btn-primary btn-lg w-100">Calculate</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <script src="/js/main.js"></script>
</body>
</html>
